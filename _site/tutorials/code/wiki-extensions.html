<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Article" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="twitter:card" content="summary">

<!-- Schema.org markup for Google+ -->
<!-- Twitter Card data -->
<!-- Open Graph data -->

    <meta name="google-site-verification" content="GK5cKdKe-CQEFsGx1pPxHFhflO88ddWG8NdWk_KDabA" />
    
    <title>Wiki Extensions - </title>
    <meta property="og:title" content="Wiki Extensions - ">
    <meta name="twitter:title" content="Wiki Extensions - ">
    <meta itemprop="name" content="Wiki Extensions - ">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="">
    <meta property="og:site_name" content="Wiki Extensions" >
    <meta property="og:url" content="/tutorials/code/wiki-extensions.html" >
    
  
    <meta name="description" content=" ...">
    <meta property="og:description" content=" ..." >
    <meta name="twitter:description" content=" ...">  
    <meta itemprop="description" content=" ...">
  
    
  
    <meta property="og:image" content="/default_preview.png">
    <meta name="twitter:image" content="/default_preview.png">
    <meta itemprop="image" content="/default_preview.png">
  
  
  <meta name="twitter:site" content="@lynnnoton">
  <meta name="twitter:creator" content="@lynnnoton">

  
    <!-- 
    
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    
    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>

    
    -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="https://use.fontawesome.com/ee2438614b.js"></script>
       
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true&amp;skin=sunburst&amp;lang=css" defer="defer"></script>


    <script>
        (function() {
          var cx = '006109472892303620439:hmwpm8s4lvi';
          var gcse = document.createElement('script');
          gcse.type = 'text/javascript';
          gcse.async = true;
          gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(gcse, s);
        })();
    </script>
      
    <script src="/scripts/default.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css">
    <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css">


    <link rel="stylesheet" type="text/css" href="/css/style.css"></link>
    <link rel="stylesheet" type="text/css" href="/css/tables.css"></link>
    <link rel="stylesheet" type="text/css" href="/css/prettify.css"></link>
    
    
      <link rel="shortcut icon" href="/images/favicon.ico">
      <link rel="apple-touch-icon" href="/images/touchicon_57.png">
      <link rel="apple-touch-icon" sizes="72x72" href="/images/touchicon_62.png">
      <link rel="apple-touch-icon" sizes="114x114" href="/images/touchicon_114.png">
      
      
  </head>

  <body>

      <a name="top"></a>     
         
         
                               
                      <div class="titlebox">
                                                    
                         <div class="blogtitle">
                          
                              <a href="">AresMUSH</a> 
                              
                          </div>
                          
                          <div class="tagline">
                                A New Breed of MUSH Server            
                            </div>
                            
                            </div>
                             
                      
                            <nav class="navbar navbar-dark">
 
    <ul class="nav navbar-nav">
      <li class="active">
        <a href="/">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Features <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/features/">Why Ares?</a></li>
          <li><a href="/features/ares-for-players.html">Ares for Players</a></li>
          <li><a href="/features/ares-for-admins.html">Ares for Admins</a></li>
          <li><a href="/features/ares-for-coders.html">Ares for Coders</a></li>
          <li><hr/></li>
          <li><a href="/web-portal">The Web Portal</a></li>
          <li><a href="/features/skills.html">Skills Systems</a></li>
          <li><a href="/handles">Player Handles</a></li>
          <li><a href="/features/server-roundup.html">Server Comparison</a></li>
        </ul>
      </li>  
      
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tutorials <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/mush-101">MUSH 101</a></li>
          <li><a href="/tutorials/play">Playing Ares</a></li>
          <li><a href="/tutorials/install">Installing Ares</a></li>
          <li><a href="/tutorials/config">Configuring Ares</a></li>
          <li><a href="/tutorials/manage">Managing Ares</a></li>
          <li><a href="/tutorials/code">Coding for Ares</a></li>
        </ul>
      </li>    
      
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">FS3 <span class="caret"></span></a>

        <ul class="dropdown-menu">
          <li><a href="/fs3/">FS3 Home</a></li>
          <li><a href="/fs3/fs3-3/">Player's Guide</a></li>
          <li><a href="/fs3/fs3-3/roll-quickref.html">Skills Quick Reference</a></li>
          <li><a href="/fs3/fs3-3/combat-quickref.html">Combat Quick Reference</a></li>
          <li><a href="/fs3/fs3-3/combat-walkthrough.html">Interactive Combat Walkthrough</a></li>
          <li><a href="/fs3/old-editions.html">Prior Edition Guides</a></li>
        </ul>
      </li>
      
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Code <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/code/">Source Code</a></li>
          <li><a href="/tutorials/code">Learn to Code</a></li>
          <li><a href="https://github.com/AresMUSH/aresmush/releases">Release Notes <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
        </ul>
      </li>
      
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Community <span class="caret"></span></a>
        
        <ul class="dropdown-menu">
          <li><a href="http://arescentral.aresmush.com">AresCentral Directory <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
          <li><a href="http://forum.aresmush.com">Discussion Forum <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
          <li><a href="http://logcleaner.aresmush.com/">RP Log Cleaner <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
        </ul>
      </li>

      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/feedback.html">Contact Us</a>
          <li><a href="/license.html">License</a>
          <li><a href="/privacy.html">Privacy Policy</a>
        </ul>
      </li>

    </ul>
</nav>

                      
                        
         
         <div class="page-block">
         
                           <div class="row">
                         
                         
    <div class="col col-sm-9">   

<h1>Wiki Extensions</h1>

    <div class="tags-box">
                 <ul class="tags-box">
                 
                 <li>[code]</li>
                 
                 <li>[webportal]</li>
                 
                 </ul>
    </div>
                               
             <div class="page">
                 <p>The wiki supports a number of Markdown extensions designed to replicate Wikidot syntax and provide some MU-specific utilities like a scene list.  You can edit the code to add new extensions.</p>

<p>Wiki extensions live in the <code class="language-ruby highlighter-rouge"><span class="n">aresmush</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">website</span><span class="o">/</span><span class="n">wiki_markdown</span></code> folder.</p>

<div id="inline_toc">
  <p><strong>Table of Contents</strong></p>

<ul id="markdown-toc">
  <li><a href="#markdown-processing" id="markdown-toc-markdown-processing">Markdown Processing</a>    <ul>
      <li><a href="#pre-processing" id="markdown-toc-pre-processing">Pre-Processing</a></li>
      <li><a href="#processing" id="markdown-toc-processing">Processing</a></li>
      <li><a href="#post-processing" id="markdown-toc-post-processing">Post-Processing</a></li>
      <li><a href="#finalizing" id="markdown-toc-finalizing">Finalizing</a></li>
    </ul>
  </li>
  <li><a href="#creating-an-extension" id="markdown-toc-creating-an-extension">Creating an Extension</a></li>
  <li><a href="#extension-templates" id="markdown-toc-extension-templates">Extension Templates</a></li>
  <li><a href="#registring-an-extension" id="markdown-toc-registring-an-extension">Registring an Extension</a></li>
  <li><a href="#finalizer" id="markdown-toc-finalizer">Finalizer</a></li>
</ul>

</div>

<h2 id="markdown-processing">Markdown Processing</h2>

<p>Before trying to create your own extension, it’s important to understand how the markdown processing works.  The overall goal is to convert Markdown text to HTML, but there are several steps involved:</p>

<h3 id="pre-processing">Pre-Processing</h3>

<p>Pre-processing extensions operate <strong>before</strong> the other Markdown has been handled, and they usually output Markdown.  For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">somewhere</span> <span class="no">Wikidot</span> <span class="no">Style</span> <span class="no">Link</span><span class="p">]</span>
</code></pre></div></div>

<p>becomes:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="no">Wikidot</span> <span class="no">Style</span> <span class="no">Link</span><span class="p">](</span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">somewhere</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="processing">Processing</h3>

<p>This is the core of the Markdown processing engine.  It converts standard Markdown extensions to HTML.  Ares uses the <a href="https://github.com/vmg/redcarpet">Redcarpet</a> markdown engine.</p>

<h3 id="post-processing">Post-Processing</h3>

<p>Post-processing extensions operate <strong>after</strong> the other Markdown has been convered to HTML.  They output HTML.  For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[[</span><span class="n">musicplayer</span> <span class="no">E5TsA6CHpII</span> <span class="no">Description</span><span class="p">]]</span>
</code></pre></div></div>

<p>becomes:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">"row musicplayer-wrap"</span><span class="o">&gt;</span>
<span class="o">...</span> <span class="n">other</span> <span class="n">musicplayer</span> <span class="no">HTML</span>
<span class="o">&lt;</span><span class="sr">/div&gt;
</span></code></pre></div></div>

<h3 id="finalizing">Finalizing</h3>

<p>The finalizer is a special extension that operates <strong>at the end</strong> after everything else has been converted.  It has the benefit of seeing the entire text.</p>

<p>For example, the <code class="language-ruby highlighter-rouge"><span class="p">[[</span><span class="n">toc</span><span class="p">]]</span></code> extension needs to know all of the headings in the entire text so it can build the table of contents.</p>

<h2 id="creating-an-extension">Creating an Extension</h2>

<p>An extension operates on a single line of Markdown text.  It needs to be a class that implements two methods:</p>

<ul>
  <li><code class="language-ruby highlighter-rouge"><span class="n">regex</span></code> - A regular expression that examines the line and figures out if it matches the extension’s sought-after tag.</li>
  <li><code class="language-ruby highlighter-rouge"><span class="n">parse</span></code> - A method that operates on the line and returns new text (either Markdown for a preprocessing extension, or HTML for a postprocessing extension).  The <code class="language-ruby highlighter-rouge"><span class="n">matches</span></code> parameter is the result of the regex call.</li>
</ul>

<p>For example, the StartCollapsibleMarkdownExtension class matches text in the form <code class="language-ruby highlighter-rouge"><span class="p">[[</span><span class="n">collapsible</span> <span class="no">Show</span> <span class="no">More</span><span class="p">]]</span></code>.  The button text piece is enclosed in () to make it a regex match group, and can be accessed via <code class="language-ruby highlighter-rouge"><span class="n">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code> in the parse method.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StartCollapsibleMarkdownExtension</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">regex</span>
    <span class="sr">/\[\[collapsible ([^\]]*)\]\]/i</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">sinatra</span><span class="p">)</span>
    <span class="n">button_text</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="o">...</span>      
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="extension-templates">Extension Templates</h2>

<p>Several extensions use Handlebars templates, similar to the web portal, to help format their output.  For example, the music player extension has a fair bit of HTML involved.  Create a template by placing it in <code class="language-ruby highlighter-rouge"><span class="n">aresmush</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">website</span><span class="o">/</span><span class="n">templates</span></code> and then use it in your extension class.  You can even pass variables to it.  For example, the collapsible extension uses a template:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">template</span> <span class="o">=</span> <span class="no">HandlebarsTemplate</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="no">AresMUSH</span><span class="p">.</span><span class="nf">plugin_path</span><span class="p">,</span> <span class="s1">'website'</span><span class="p">,</span> <span class="s1">'templates'</span><span class="p">,</span> <span class="s1">'collapsible.hbs'</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"button_text"</span> <span class="o">=&gt;</span> <span class="n">button_text</span><span class="p">,</span> <span class="s2">"id"</span> <span class="o">=&gt;</span> <span class="no">SecureRandom</span><span class="p">.</span><span class="nf">uuid</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span> <span class="p">}</span>
<span class="n">template</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
</code></pre></div></div>

<h2 id="registring-an-extension">Registring an Extension</h2>

<p>Extensions must be registered by adding them to the list in <code class="language-ruby highlighter-rouge"><span class="no">WikiMarkdownExtensions</span></code>.  Just add the class name to either the pre- or post-processing extension lists.</p>

<blockquote>
  <p><i class="fa fa-exclamation-triangle"></i> <strong>Note:</strong>  Not sure whether to make your extension a pre- or post-processing one?  As a general rule, pre-processing extensions output Markdown and are pretty simple.  Post-processing extensions are complex, may involve templates, and may contain Markdown inside them.</p>
</blockquote>

<h2 id="finalizer">Finalizer</h2>

<p>The <code class="language-ruby highlighter-rouge"><span class="no">MarkdownFinalizer</span></code> class performs the final processing - things that examine the entire text after all other Markdown formatting has been done.</p>

             </div>             
                           </div>
              
                           <div class="col col-sm-3">
                                                 <div class="sidebar">   
                 
<div id="search-box">
  <!-- SearchBox widget will appear here -->
</div>
                  
<div class="sidebar-title">See AresMUSH In Action</div>

<p>Visit the Ares <a href="http://mush.aresmush.com">Demo Game</a>.</p>

<p>Find other Ares games at <a href="http://arescentral.aresmush.com">AresCentral</a>.</p>


<div class="sidebar-title">Follow Us on Facebook</div>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=1423276681271936";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-page" data-href="https://www.facebook.com/aresmush/" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="false"><div class="fb-xfbml-parse-ignore"><blockquote cite="https://www.facebook.com/aresmush/"><a href="https://www.facebook.com/aresmush/">Ares Mush</a></blockquote></div></div>

<div class="sidebar-title">Discuss Ares</div>

Have a question?  Want to talk about AresMUSH (or MU*s in general)?  Visit our <a href="http://forum.aresmush.com">Discussion Forum</a>.
                  
                  

                  <div class="sidebar-title">Stay Up to Date</div>
                          
                          Get important updates about Ares on <a href="https://www.facebook.com/aresmush/">Facebook</a> or the <a href="http://forum.aresmush.com">Discussion Forum</a>.

              <div id="searchModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Search Results</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
       

       <div id="search-hits">
         <!-- Hits widget will appear here -->
       </div>


       <div id="search-pagination">
         <!-- Pagination widget will appear here -->
       </div>
       
       
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>


<script src="/scripts/search.js"></script>
<script>
  initializeSearch( 'NI38C577BA',
    '29793fd9084a3446072c14e471e32589',
    'aresmush.com',
    ' ' );
</script>

                  

                  
                
                  
                           </div>
</div>
                          
              </div>
              
          </div>
          

          <div class="footer">
             <p> &copy;  2013 with help from the <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a> blog engine.
              </p>
          </div>
          
      
     
  </body>
</html>
