<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Article" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="twitter:card" content="summary">

<!-- Schema.org markup for Google+ -->
<!-- Twitter Card data -->
<!-- Open Graph data -->

    <meta name="google-site-verification" content="GK5cKdKe-CQEFsGx1pPxHFhflO88ddWG8NdWk_KDabA" />
    
    <title>Command Errors - </title>
    <meta property="og:title" content="Command Errors - ">
    <meta name="twitter:title" content="Command Errors - ">
    <meta itemprop="name" content="Command Errors - ">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="">
    <meta property="og:site_name" content="Command Errors" >
    <meta property="og:url" content="/tutorials/code/quickstart/command-errors.html" >
    
  
    <meta name="description" content=" ...">
    <meta property="og:description" content=" ..." >
    <meta name="twitter:description" content=" ...">  
    <meta itemprop="description" content=" ...">
  
    
  
    <meta property="og:image" content="/default_preview.png">
    <meta name="twitter:image" content="/default_preview.png">
    <meta itemprop="image" content="/default_preview.png">
  
  
  <meta name="twitter:site" content="@lynnnoton">
  <meta name="twitter:creator" content="@lynnnoton">

  
    <!-- 
    
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    
    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>

    
    -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="https://use.fontawesome.com/ee2438614b.js"></script>
       
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true&amp;skin=sunburst&amp;lang=css" defer="defer"></script>


    <script>
        (function() {
          var cx = '006109472892303620439:hmwpm8s4lvi';
          var gcse = document.createElement('script');
          gcse.type = 'text/javascript';
          gcse.async = true;
          gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(gcse, s);
        })();
    </script>
      
    <script src="/scripts/default.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css">
    <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css">


    <link rel="stylesheet" type="text/css" href="/css/style.css"></link>
    <link rel="stylesheet" type="text/css" href="/css/tables.css"></link>
    <link rel="stylesheet" type="text/css" href="/css/prettify.css"></link>
    
    
      <link rel="shortcut icon" href="/images/favicon.ico">
      <link rel="apple-touch-icon" href="/images/touchicon_57.png">
      <link rel="apple-touch-icon" sizes="72x72" href="/images/touchicon_62.png">
      <link rel="apple-touch-icon" sizes="114x114" href="/images/touchicon_114.png">
      
      
  </head>

  <body>

      <a name="top"></a>     
         
         
                               
                      <div class="titlebox">
                                                    
                         <div class="blogtitle">
                          
                              <a href="">AresMUSH</a> 
                              
                          </div>
                          
                          <div class="tagline">
                                A New Breed of MUSH Server            
                            </div>
                            
                            </div>
                             
                      
                            <nav class="navbar navbar-dark">
 
    <ul class="nav navbar-nav">
      <li class="active">
        <a href="/">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Features <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/features/">Why Ares?</a></li>
          <li><a href="/features/ares-for-players.html">Ares for Players</a></li>
          <li><a href="/features/ares-for-admins.html">Ares for Admins</a></li>
          <li><a href="/features/ares-for-coders.html">Ares for Coders</a></li>
          <li><hr/></li>
          <li><a href="/web-portal">The Web Portal</a></li>
          <li><a href="/features/skills.html">Skills Systems</a></li>
          <li><a href="/handles">Player Handles</a></li>
          <li><a href="/features/server-roundup.html">Server Comparison</a></li>
        </ul>
      </li>  
      
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tutorials <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/mush-101">MUSH 101</a></li>
          <li><a href="/tutorials/play">Playing Ares</a></li>
          <li><a href="/tutorials/install">Installing Ares</a></li>
          <li><a href="/tutorials/config">Configuring Ares</a></li>
          <li><a href="/tutorials/manage">Managing Ares</a></li>
          <li><a href="/tutorials/code">Coding for Ares</a></li>
        </ul>
      </li>    
      
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">FS3 <span class="caret"></span></a>

        <ul class="dropdown-menu">
          <li><a href="/fs3/">FS3 Home</a></li>
          <li><a href="/fs3/fs3-3/">Player's Guide</a></li>
          <li><a href="/fs3/fs3-3/roll-quickref.html">Skills Quick Reference</a></li>
          <li><a href="/fs3/fs3-3/combat-quickref.html">Combat Quick Reference</a></li>
          <li><a href="/fs3/fs3-3/combat-walkthrough.html">Interactive Combat Walkthrough</a></li>
          <li><a href="/fs3/old-editions.html">Prior Edition Guides</a></li>
        </ul>
      </li>
      
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Code <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/code/">Source Code</a></li>
          <li><a href="/tutorials/code">Learn to Code</a></li>
          <li><a href="https://github.com/AresMUSH/aresmush/releases">Release Notes <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
        </ul>
      </li>
      
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Community <span class="caret"></span></a>
        
        <ul class="dropdown-menu">
          <li><a href="http://arescentral.aresmush.com">AresCentral Directory <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
          <li><a href="http://forum.aresmush.com">Discussion Forum <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
          <li><a href="http://logcleaner.aresmush.com/">RP Log Cleaner <i class="fa fa-external-link" aria-hidden="true"></i></a></li>
        </ul>
      </li>

      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/feedback.html">Contact Us</a>
          <li><a href="/license.html">License</a>
          <li><a href="/privacy.html">Privacy Policy</a>
        </ul>
      </li>

    </ul>
</nav>

                      
                        
         
         <div class="page-block">
         
                           <div class="row">
                         
                         
    <div class="col col-sm-9">   

                               
             <div class="page">
                 
                 <h1>Command Errors</h1>
                 
                 <div class="fs3-shortcut">
                     <a href="#toc">(View Table of Contents)</a>
                 </div>
                 

                     <p>You may already have stumbled upon this, but the code we used in the previous exercise had a problem.  If you ran the <code class="language-ruby highlighter-rouge"><span class="n">tinker</span></code> command without specifying any arguments, you’d get an error.</p>

<p>Whenever the code suffers an unexpected failure, you’ll get a red “Oops! The code has lost its mind…” message explaining what the problem is.</p>

<h2 id="try-it---what-errors-look-like">Try It! - What Errors Look Like</h2>

<p>Let’s see what this looks like.  Change the tinker code back to our previous example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">handle</span>
  <span class="n">piggies</span> <span class="o">=</span> <span class="n">integer_arg</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="nf">args</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">piggies</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">emit_ooc</span> <span class="s2">"</span><span class="si">#{</span><span class="n">piggies</span><span class="si">}</span><span class="s2"> is a small number of piggies."</span>
  <span class="k">else</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">emit_ooc</span> <span class="s2">"</span><span class="si">#{</span><span class="n">piggies</span><span class="si">}</span><span class="s2"> is a lot of piggies!"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now run the <code class="language-ruby highlighter-rouge"><span class="n">tinker</span></code> command by itself without giving it any arguments.  You should get a bunch of red error text including this message:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Error</span><span class="p">:</span> <span class="s2">"undefined method `&lt;' for nil:NilClass"</span>
</code></pre></div></div>

<h2 id="try-it---looking-in-the-error-log">Try It! - Looking in the Error Log</h2>

<p>There’s minimal information about the error printed to the screen, but a lot more is captured in the game’s <a href="/tutorials/code/logs.html">log file</a>.  The log file records most commands (minus some for privacy), errors, and other important game events.</p>

<ol>
  <li>In the web portal, go to Admin -&gt; Logs.  (You can open this in a new tab to avoid losing your tinker window).</li>
  <li>Select the most recent (highest-numbered) log file.</li>
  <li>Search for “ERROR” and near the top you should see an entry like this:</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">23</span> <span class="mi">20</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">50</span> <span class="no">ERROR</span> <span class="o">-</span> <span class="no">Error</span> <span class="k">in</span> <span class="ss">tinker: </span><span class="n">client</span><span class="o">=</span><span class="mi">73</span> <span class="n">error</span><span class="o">=</span><span class="n">undefined</span> <span class="nb">method</span> <span class="sb">`&lt;' for nil:NilClass backtrace=["/home/ares/aresmush/plugins/tinker/commands/tinker_cmd.rb:14:in `</span><span class="n">handle</span><span class="s1">'", "/home/ares/aresmush/engine/aresmush/plugin/command_handler.rb:25:in `on_command'</span><span class="s2">",
... other junk ...
 "</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ares</span><span class="o">/</span><span class="n">aresmush</span><span class="o">/</span><span class="n">engine</span><span class="o">/</span><span class="n">aresmush</span><span class="o">/</span><span class="n">commands</span><span class="o">/</span><span class="n">dispatcher</span><span class="p">.</span><span class="nf">rb</span><span class="p">:</span><span class="mi">137</span><span class="ss">:in</span> <span class="sb">`with_error_handling'", "/home/ares/aresmush/engine/aresmush/commands/dispatcher.rb:66:in `</span><span class="n">on_command</span><span class="err">'</span><span class="s2">"] 
</span></code></pre></div></div>

<p>This shows you the exact link of code that had the problem - <code class="language-ruby highlighter-rouge"><span class="n">tinker_cmd</span><span class="p">.</span><span class="nf">rb</span></code> line 14 - and what’s called a “stack trace” showing all the method calls leading up to it.  We can use this information to find out that our problem is the line of code:  <code class="language-ruby highlighter-rouge"><span class="k">if</span> <span class="p">(</span><span class="n">piggies</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span></code>.</p>

<h2 id="try-it---debugging">Try It! - Debugging</h2>

<p>So now we know where the error is happening, but we still don’t know <em>why</em>.  We’ll need to do some debugging.  The ‘5’ looks okay, but maybe there’s something wrong with our <code class="language-ruby highlighter-rouge"><span class="n">piggies</span></code> variable.  Let’s add a log statement to our code to figure out what’s going on.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">handle</span>
  <span class="n">piggies</span> <span class="o">=</span> <span class="n">integer_arg</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="nf">args</span><span class="p">)</span>
  <span class="no">Global</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">debug</span> <span class="s2">"Number of piggies was: </span><span class="si">#{</span><span class="n">piggies</span><span class="si">}</span><span class="s2">."</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">piggies</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">emit_ooc</span> <span class="s2">"</span><span class="si">#{</span><span class="n">piggies</span><span class="si">}</span><span class="s2"> is a small number of piggies."</span>
  <span class="k">else</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">emit_ooc</span> <span class="s2">"</span><span class="si">#{</span><span class="n">piggies</span><span class="si">}</span><span class="s2"> is a lot of piggies!"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If we log in the log file again (you’ll need to reload the page if you left it open in a different tab), we’ll see a line like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">23</span> <span class="mi">20</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">09</span> <span class="no">DEBUG</span> <span class="o">-</span> <span class="no">Number</span> <span class="n">of</span> <span class="n">piggies</span> <span class="ss">was: </span><span class="o">.</span> 
</code></pre></div></div>

<p>We have no number piggies specified!  That makes sense, because we didn’t actually type a number in our tinker command.  Because we left off the number of piggies, <code class="language-ruby highlighter-rouge"><span class="n">integer_arg</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="nf">args</span><span class="p">)</span></code> just returns nil.  In Ruby, you aren’t allowed to do a comparison between nil and a number - hence the error.</p>

<h2 id="try-it---adding-an-error-check">Try It! - Adding An Error Check</h2>

<p>So now we know where and why the error is happening.  Let’s add an error check to make sure the player specified a number of piggies.  Give it a try:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">handle</span>
  <span class="n">piggies</span> <span class="o">=</span> <span class="n">integer_arg</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="nf">args</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">piggies</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">emit_failure</span> <span class="s2">"You didn't say how many piggies you had."</span>
    <span class="k">return</span>
  <span class="k">end</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="n">piggies</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">emit_ooc</span> <span class="s2">"</span><span class="si">#{</span><span class="n">piggies</span><span class="si">}</span><span class="s2"> is a small number of piggies."</span>
  <span class="k">else</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">emit_ooc</span> <span class="s2">"</span><span class="si">#{</span><span class="n">piggies</span><span class="si">}</span><span class="s2"> is a lot of piggies!"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now if we fail to specify an argument, we’ll get an error message and the handler will return (aka stop handling the command.)</p>


                 <div class="tutorial-nav">
                     <p>This article is part of the <a href="/tutorials/code/quickstart">Code Quickstart</a> tutorial.</p>
    
                     <div class="pagination-block">
                         <ul>
                             
                             <li><a href="/tutorials/code/quickstart/parsing-args.html"> &larr; Previous</a></li>
                             
            
                             <li><a href="/tutorials/code/quickstart">Back to Start</a> </li>
            
        
                             
                             <li><a href="/tutorials/code/quickstart/config-intro.html">Next &rarr; </a></li>
                             
                         </ul>
                     </div>
    
                     <br/>
                 </div>
                 
             </div>             
                           </div>
              
              
                  <div class="col col-sm-3">
                      
                      
                      <a name="toc"></a>
                      <div class="sidebar fs3-sidebar"> 
                      
                        <div id="search-box">
  <!-- SearchBox widget will appear here -->
</div>
                      
                      <h2>Code Quickstart</h2>
                      
                     
                      
                                          
                      
                                          
                      
                                          
                                          <ul>
  <li><a href="/tutorials/code/quickstart/">Tutorial Overview</a></li>
  <li><a href="/tutorials/code/quickstart/try-ruby.html">Try Ruby</a></li>
  <li><a href="/tutorials/code/quickstart/hello-mush.html">Hello MUSH</a></li>
  <li><a href="/tutorials/code/quickstart/tinker-intro.html">Tinkering</a></li>
  <li><a href="/tutorials/code/quickstart/command-handlers.html">Command Handlers</a></li>
  <li><a href="/tutorials/code/quickstart/emits.html">Emits</a></li>
  <li><a href="/tutorials/code/quickstart/templates-intro.html">Templates</a></li>
  <li><a href="/tutorials/code/quickstart/command-args.html">Command Switches and Args</a></li>
  <li><a href="/tutorials/code/quickstart/parsing-args.html">Parsing Args</a></li>
  <li><a href="/tutorials/code/quickstart/command-errors.html">Command Error Checking</a></li>
  <li><a href="/tutorials/code/quickstart/config-intro.html">Configuration</a></li>
  <li><a href="/tutorials/code/quickstart/localization-intro.html">Localization</a></li>
  <li><a href="/tutorials/code/quickstart/db-intro.html">Database Queries and Updates</a></li>
  <li><a href="/tutorials/code/quickstart/apis.html">Common APIs</a></li>
  <li><a href="/tutorials/code/quickstart/next-steps.html">Next Steps</a></li>
</ul>

                                          
                      
                                          
                      
                                          
                      
                                          
                      
                  </div>
              </div>

              <div id="searchModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Search Results</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
       

       <div id="search-hits">
         <!-- Hits widget will appear here -->
       </div>


       <div id="search-pagination">
         <!-- Pagination widget will appear here -->
       </div>
       
       
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>


<script src="/scripts/search.js"></script>
<script>
  initializeSearch( 'NI38C577BA',
    '29793fd9084a3446072c14e471e32589',
    'aresmush.com',
    ' ' );
</script>
              
</div>


                          
              </div>
              
          </div>
          

          <div class="footer">
             <p> &copy;  2013 with help from the <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a> blog engine.
              </p>
          </div>
          
      
     
  </body>
</html>
